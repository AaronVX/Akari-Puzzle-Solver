import Code.Game as game
import numpy as np

counter = 0

def solvePuzzle(puzzle):

    if solvePuzzleUtil(puzzle):
        puzzle.print_puzzle
        print("puzzle solved. \ntotal steps: {}".format(counter))
        return True
    else:
        print("solution doesn't exist")
        return False


def solvePuzzleUtil(puzzle):
    global counter
    if puzzle.isFinished() is True:
        return True

    lightBulbs = np.where(puzzle.arr == puzzle.LIGHT_OFF)

    if len(lightBulbs[0]) > 0:
        for row, col in zip(lightBulbs[0], lightBulbs[1]):
            if puzzle.isValidBulb(row, col) and puzzle.isWallNeigbourValid(row, col):
                puzzle.insert_light_bulb(row, col)
                counter += 1
                # print(puzzle.isFinished is True)
                if solvePuzzleUtil(puzzle):
                    return True

    return False


if __name__ == '__main__':
    file = game.read_puzzle_file()
    puzzle = game.get_next_puzzle(file)
    puzzle.print_puzzle()
    solvePuzzle(puzzle)
